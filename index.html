<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind:wght@700&family=Oswald:wght@700&display=swap');

        body { margin: 0; padding: 0; overflow: hidden; background: transparent; font-family: 'Hind', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        
        #breaking-box {
            width: 900px;
            height: 500px;
            background: linear-gradient(135deg, #1a1a1a 0%, #000 100%);
            border: 6px solid #ffcc00;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,1);
            border-radius: 15px;
        }

        #header {
            background: #cc0000;
            color: white;
            font-family: 'Oswald', sans-serif;
            font-size: 55px;
            padding: 15px;
            text-align: center;
            border-bottom: 6px solid #ffcc00;
            text-transform: uppercase;
            letter-spacing: 4px;
            animation: glow 1.5s infinite alternate;
        }

        #content {
            padding: 40px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            background: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
        }

        #headline {
            color: #ffcc00;
            font-size: 60px;
            font-weight: 900;
            margin-bottom: 25px;
            line-height: 1.1;
            text-shadow: 3px 3px 10px rgba(0,0,0,0.5);
        }

        #details {
            color: white;
            font-size: 34px;
            font-weight: 500;
            line-height: 1.4;
        }

        @keyframes glow { from { background: #cc0000; box-shadow: inset 0 0 20px #ff0000; } to { background: #ff0000; box-shadow: inset 0 0 40px #cc0000; } }
        
        /* Transition effect */
        .slide-up { animation: slideUp 0.6s ease-out; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body onclick="startLiveNews()">

    <div id="breaking-box">
        <div id="header">BREAKING NEWS</div>
        <div id="content" id="news-anim">
            <div id="headline">लोडिंग...</div>
            <div id="details">शीट से खबरें आ रही हैं...</div>
        </div>
    </div>

    <script>
        // --- अपनी Google Sheet ID यहाँ डालें ---
        const SHEET_ID = '2PACX-1vSja0mAGnsQR3ByKHh3-qdEx9P-zBuxmsE635ZnCW9Igf2zjmd41kWeaBDqTPBgeQI8bjPI0BBWusYD'; 
        const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`;

        let newsItems = [];
        let currentIndex = 0;
        const synth = window.speechSynthesis;
        
        // Beep Sound का जुगाड़ (No external file needed)
        const beep = new Audio('https://www.soundjay.com/buttons/sounds/beep-07.mp3');

        async function fetchSheet() {
            try {
                const response = await fetch(CSV_URL);
                const data = await response.text();
                const rows = data.split('\n').map(row => row.split(','));
                newsItems = rows.filter(r => r[0] && r[0].trim() !== "");
                if (!synth.speaking) playNextNews();
            } catch (e) { console.error("Sheet Error"); }
        }

        function playNextNews() {
            if (newsItems.length === 0) return;
            if (currentIndex >= newsItems.length) currentIndex = 0;

            const head = newsItems[currentIndex][0].replace(/"/g, "");
            const detail = (newsItems[currentIndex][1] || "").replace(/"/g, "");

            // 1. Beep Sound बजाएं
            beep.play().catch(e => console.log("Audio Error"));

            // 2. स्क्रीन अपडेट करें और एनीमेशन दें
            const content = document.getElementById('content');
            content.classList.remove('slide-up');
            void content.offsetWidth; // रिफ्लो के लिए
            content.classList.add('slide-up');
            
            document.getElementById('headline').innerText = head;
            document.getElementById('details').innerText = detail;

            // 3. साफ़ आवाज़ में बोलें
            const utter = new SpeechSynthesisUtterance(`${head}। ${detail}`);
            utter.lang = 'hi-IN';
            utter.rate = 0.85; // नेचुरल स्पीड
            utter.pitch = 1;

            // आवाज़ फिक्स (Van-Van रोकने के लिए)
            const voices = synth.getVoices();
            const hindiVoice = voices.find(v => v.lang.includes('hi-IN') || v.lang.includes('hi'));
            if (hindiVoice) utter.voice = hindiVoice;

            utter.onend = () => {
                currentIndex++;
                setTimeout(playNextNews, 2500); // खबर खत्म होने के 2.5 सेकंड बाद अगली खबर
            };

            synth.speak(utter);
        }

        function startLiveNews() {
            if (synth.speaking) synth.cancel();
            fetchSheet();
        }

        // हर 1 मिनट में शीट चेक करें
        setInterval(fetchSheet, 60000);
        window.speechSynthesis.onvoiceschanged = () => { fetchSheet(); };
    </script>
</body>
</html>
